// Generated by LiveScript 1.3.1
(function(){function t(t,e,n){return function(){return(n||t)[e].apply(t,arguments)}}function e(t,e){for(var n=[];e>0;(e>>=1)&&(t=t.concat(t)))1&e&&n.push.apply(n,t)
return n}var n
n=function(){function n(n){this.size=null!=n?n:4,this.init=t(this,"init",i),this.nextTurn=t(this,"nextTurn",i),this.isGameOver=t(this,"isGameOver",i),this.checkGameOver=t(this,"checkGameOver",i),this.fillCells=t(this,"fillCells",i),this.selectCell=t(this,"selectCell",i),this.data=e(e([0],this.size),this.size),this.currentPlayer=2,this.startPos=null,this.stateElement=document.getElementById("state"),this.playerElement=document.getElementById("player"),this.init(),this.nextTurn()}n.displayName="Game"
var i=n.prototype
return i.selectCell=function(t){return+t.target.innerText?alert("Эту клетку нельзя выбрать"):(t.target.className="start-cell",null==this.startPos?(this.startPos=+t.target.id,this.stateElement.innerText="Выберите конечную клетку"):this.fillCells(this.startPos,+t.target.id)?this.checkGameOver():void 0)},i.fillCells=function(t,e){var n,i,s,r
if(t>e&&(t=[e,e=t][0]),n=e-t>=this.size||(e/this.size|0)!==(t/this.size|0),n&&(e-t)%this.size)return alert("Выберите конечную клетку на одной горизонталиили вертикали с текущей клеткой")
for(i=t;e>=i;++i)s=i,(s%this.size===e%this.size&&n||!n)&&(this.data[s]=1,r=document.getElementById(s),r.innerText=1,r.className="touched-cell")
return!0},i.checkGameOver=function(){return this.isGameOver()?(alert("Победа за игроком номер "+this.currentPlayer),createGame(this.size)):this.nextTurn()},i.isGameOver=function(){return!this.data.filter(function(t){return 0===t}).length},i.nextTurn=function(){return this.currentPlayer=1===this.currentPlayer?2:1,this.playerElement.innerText="Ход "+this.currentPlayer+" игрока",this.stateElement.innerText="Выберите начальную клетку",this.startPos=null},i.init=function(){var t,e,n,i,s=[]
document.getElementsByTagName("table").length&&document.body.removeChild(document.getElementsByTagName("table")[0]),t=document.body.appendChild(document.createElement("table"))
for(e in this.data)e%this.size||t.appendChild(n=document.createElement("tr")),i=document.createElement("td"),i.id=e,i.onclick=this.selectCell,i.innerText=0,s.push(n.appendChild(i))
return s},n}(),this.createGame=function(t){return new n(t)},window.onload=function(){return createGame(+document.getElementById("size").value)}}).call(this)
